{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 136,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "from tensorflow import tensordot\n",
    "from tensorflow import keras\n",
    "from tensorflow.keras import layers"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/1d/7ynr__411fx9qj9r1bgh72cc0000gn/T/ipykernel_7568/48023150.py:5: DtypeWarning: Columns (3) have mixed types. Specify dtype option on import or set low_memory=False.\n",
      "  books_df = pd.read_csv(books_data_path)\n"
     ]
    }
   ],
   "source": [
    "books_data_path = \"data/Books.csv\"\n",
    "ratings_data_path = \"data/Ratings.csv\"\n",
    "users_data_path = \"data/Users.csv\"\n",
    "\n",
    "books_df = pd.read_csv(books_data_path)\n",
    "ratings_df = pd.read_csv(ratings_data_path)\n",
    "users_df = pd.read_csv(users_data_path)\n",
    "\n",
    "# Drop unnecessary columns from the books DataFrame\n",
    "#columns_to_drop = ['Image-URL-S', 'Image-URL-M', 'Image-URL-L']\n",
    "#books_df.drop(labels=columns_to_drop, axis=1, inplace=True)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 138,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Empty DataFrame\n",
      "Columns: [ISBN, Book-Title, Book-Author, Year-Of-Publication, Publisher, Image-URL-S, Image-URL-M, Image-URL-L]\n",
      "Index: []\n",
      "ISBN                   object\n",
      "Book-Title             object\n",
      "Book-Author            object\n",
      "Year-Of-Publication     int64\n",
      "Publisher              object\n",
      "Image-URL-S            object\n",
      "Image-URL-M            object\n",
      "Image-URL-L            object\n",
      "dtype: object\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/1d/7ynr__411fx9qj9r1bgh72cc0000gn/T/ipykernel_7568/1378467526.py:6: UserWarning: Boolean Series key will be reindexed to match DataFrame index.\n",
      "  print(books_df[invalid_publication_years])\n"
     ]
    }
   ],
   "source": [
    "# Identify and drop rows with problematic 'Year-Of-Publication' values\n",
    "invalid_publication_years = (books_df['Year-Of-Publication'] == 'DK Publishing Inc') | (books_df['Year-Of-Publication'] == 'Gallimard')\n",
    "books_df = books_df.drop(books_df[invalid_publication_years].index)\n",
    "\n",
    "# Verify that rows with invalid 'Year-Of-Publication' values are dropped\n",
    "print(books_df[invalid_publication_years])\n",
    "\n",
    "# Convert 'Year-Of-Publication' to integer type\n",
    "books_df['Year-Of-Publication'] = books_df['Year-Of-Publication'].astype(int)\n",
    "\n",
    "# Print data types of the DataFrame\n",
    "print(books_df.dtypes)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 139,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Year-Of-Publication</th>\n",
       "      <th>Publisher</th>\n",
       "      <th>Image-URL-S</th>\n",
       "      <th>Image-URL-M</th>\n",
       "      <th>Image-URL-L</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0195153448</td>\n",
       "      <td>Classical Mythology</td>\n",
       "      <td>Mark P. O. Morford</td>\n",
       "      <td>2002</td>\n",
       "      <td>Oxford University Press</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0002005018</td>\n",
       "      <td>Clara Callan</td>\n",
       "      <td>Richard Bruce Wright</td>\n",
       "      <td>2001</td>\n",
       "      <td>HarperFlamingo Canada</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0060973129</td>\n",
       "      <td>Decision in Normandy</td>\n",
       "      <td>Carlo D'Este</td>\n",
       "      <td>1991</td>\n",
       "      <td>HarperPerennial</td>\n",
       "      <td>http://images.amazon.com/images/P/0060973129.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0060973129.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0060973129.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0374157065</td>\n",
       "      <td>Flu: The Story of the Great Influenza Pandemic...</td>\n",
       "      <td>Gina Bari Kolata</td>\n",
       "      <td>1999</td>\n",
       "      <td>Farrar Straus Giroux</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0393045218</td>\n",
       "      <td>The Mummies of Urumchi</td>\n",
       "      <td>E. J. W. Barber</td>\n",
       "      <td>1999</td>\n",
       "      <td>W. W. Norton &amp;amp; Company</td>\n",
       "      <td>http://images.amazon.com/images/P/0393045218.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0393045218.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0393045218.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271355</th>\n",
       "      <td>0440400988</td>\n",
       "      <td>There's a Bat in Bunk Five</td>\n",
       "      <td>Paula Danziger</td>\n",
       "      <td>1988</td>\n",
       "      <td>Random House Childrens Pub (Mm)</td>\n",
       "      <td>http://images.amazon.com/images/P/0440400988.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0440400988.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0440400988.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271356</th>\n",
       "      <td>0525447644</td>\n",
       "      <td>From One to One Hundred</td>\n",
       "      <td>Teri Sloat</td>\n",
       "      <td>1991</td>\n",
       "      <td>Dutton Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0525447644.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0525447644.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0525447644.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271357</th>\n",
       "      <td>006008667X</td>\n",
       "      <td>Lily Dale : The True Story of the Town that Ta...</td>\n",
       "      <td>Christine Wicker</td>\n",
       "      <td>2004</td>\n",
       "      <td>HarperSanFrancisco</td>\n",
       "      <td>http://images.amazon.com/images/P/006008667X.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/006008667X.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/006008667X.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271358</th>\n",
       "      <td>0192126040</td>\n",
       "      <td>Republic (World's Classics)</td>\n",
       "      <td>Plato</td>\n",
       "      <td>1996</td>\n",
       "      <td>Oxford University Press</td>\n",
       "      <td>http://images.amazon.com/images/P/0192126040.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0192126040.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0192126040.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271359</th>\n",
       "      <td>0767409752</td>\n",
       "      <td>A Guided Tour of Rene Descartes' Meditations o...</td>\n",
       "      <td>Christopher  Biffle</td>\n",
       "      <td>2000</td>\n",
       "      <td>McGraw-Hill Humanities/Social Sciences/Languages</td>\n",
       "      <td>http://images.amazon.com/images/P/0767409752.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0767409752.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0767409752.0...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>271357 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              ISBN                                         Book-Title  \\\n",
       "0       0195153448                                Classical Mythology   \n",
       "1       0002005018                                       Clara Callan   \n",
       "2       0060973129                               Decision in Normandy   \n",
       "3       0374157065  Flu: The Story of the Great Influenza Pandemic...   \n",
       "4       0393045218                             The Mummies of Urumchi   \n",
       "...            ...                                                ...   \n",
       "271355  0440400988                         There's a Bat in Bunk Five   \n",
       "271356  0525447644                            From One to One Hundred   \n",
       "271357  006008667X  Lily Dale : The True Story of the Town that Ta...   \n",
       "271358  0192126040                        Republic (World's Classics)   \n",
       "271359  0767409752  A Guided Tour of Rene Descartes' Meditations o...   \n",
       "\n",
       "                 Book-Author  Year-Of-Publication  \\\n",
       "0         Mark P. O. Morford                 2002   \n",
       "1       Richard Bruce Wright                 2001   \n",
       "2               Carlo D'Este                 1991   \n",
       "3           Gina Bari Kolata                 1999   \n",
       "4            E. J. W. Barber                 1999   \n",
       "...                      ...                  ...   \n",
       "271355        Paula Danziger                 1988   \n",
       "271356            Teri Sloat                 1991   \n",
       "271357      Christine Wicker                 2004   \n",
       "271358                 Plato                 1996   \n",
       "271359   Christopher  Biffle                 2000   \n",
       "\n",
       "                                               Publisher  \\\n",
       "0                                Oxford University Press   \n",
       "1                                  HarperFlamingo Canada   \n",
       "2                                        HarperPerennial   \n",
       "3                                   Farrar Straus Giroux   \n",
       "4                             W. W. Norton &amp; Company   \n",
       "...                                                  ...   \n",
       "271355                   Random House Childrens Pub (Mm)   \n",
       "271356                                      Dutton Books   \n",
       "271357                                HarperSanFrancisco   \n",
       "271358                           Oxford University Press   \n",
       "271359  McGraw-Hill Humanities/Social Sciences/Languages   \n",
       "\n",
       "                                              Image-URL-S  \\\n",
       "0       http://images.amazon.com/images/P/0195153448.0...   \n",
       "1       http://images.amazon.com/images/P/0002005018.0...   \n",
       "2       http://images.amazon.com/images/P/0060973129.0...   \n",
       "3       http://images.amazon.com/images/P/0374157065.0...   \n",
       "4       http://images.amazon.com/images/P/0393045218.0...   \n",
       "...                                                   ...   \n",
       "271355  http://images.amazon.com/images/P/0440400988.0...   \n",
       "271356  http://images.amazon.com/images/P/0525447644.0...   \n",
       "271357  http://images.amazon.com/images/P/006008667X.0...   \n",
       "271358  http://images.amazon.com/images/P/0192126040.0...   \n",
       "271359  http://images.amazon.com/images/P/0767409752.0...   \n",
       "\n",
       "                                              Image-URL-M  \\\n",
       "0       http://images.amazon.com/images/P/0195153448.0...   \n",
       "1       http://images.amazon.com/images/P/0002005018.0...   \n",
       "2       http://images.amazon.com/images/P/0060973129.0...   \n",
       "3       http://images.amazon.com/images/P/0374157065.0...   \n",
       "4       http://images.amazon.com/images/P/0393045218.0...   \n",
       "...                                                   ...   \n",
       "271355  http://images.amazon.com/images/P/0440400988.0...   \n",
       "271356  http://images.amazon.com/images/P/0525447644.0...   \n",
       "271357  http://images.amazon.com/images/P/006008667X.0...   \n",
       "271358  http://images.amazon.com/images/P/0192126040.0...   \n",
       "271359  http://images.amazon.com/images/P/0767409752.0...   \n",
       "\n",
       "                                              Image-URL-L  \n",
       "0       http://images.amazon.com/images/P/0195153448.0...  \n",
       "1       http://images.amazon.com/images/P/0002005018.0...  \n",
       "2       http://images.amazon.com/images/P/0060973129.0...  \n",
       "3       http://images.amazon.com/images/P/0374157065.0...  \n",
       "4       http://images.amazon.com/images/P/0393045218.0...  \n",
       "...                                                   ...  \n",
       "271355  http://images.amazon.com/images/P/0440400988.0...  \n",
       "271356  http://images.amazon.com/images/P/0525447644.0...  \n",
       "271357  http://images.amazon.com/images/P/006008667X.0...  \n",
       "271358  http://images.amazon.com/images/P/0192126040.0...  \n",
       "271359  http://images.amazon.com/images/P/0767409752.0...  \n",
       "\n",
       "[271357 rows x 8 columns]"
      ]
     },
     "execution_count": 139,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "books_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 140,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Select the first 20000 rows from the ratings DataFrame\n",
    "final_ratings_df = ratings_df[:20000]\n",
    "\n",
    "# Merge ratings and books DataFrames based on 'ISBN' using a left join\n",
    "merged_books_ratings = pd.merge(ratings_df, books_df, on='ISBN', how='left')\n",
    "\n",
    "# Group by 'ISBN' and calculate the sum of each column\n",
    "\n",
    "\n",
    "dropped_books = merged_books_ratings.dropna()\n",
    "\n",
    "cleaned_books = dropped_books.sort_values('ISBN', ascending=True)\n",
    "\n",
    "collaborative_books = cleaned_books.drop_duplicates('ISBN')\n",
    "\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 141,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>User-ID</th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Rating</th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Year-Of-Publication</th>\n",
       "      <th>Publisher</th>\n",
       "      <th>Image-URL-S</th>\n",
       "      <th>Image-URL-M</th>\n",
       "      <th>Image-URL-L</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>703628</th>\n",
       "      <td>171118</td>\n",
       "      <td>0000913154</td>\n",
       "      <td>8</td>\n",
       "      <td>The Way Things Work: An Illustrated Encycloped...</td>\n",
       "      <td>C. van Amerongen (translator)</td>\n",
       "      <td>1967.0</td>\n",
       "      <td>Simon &amp;amp; Schuster</td>\n",
       "      <td>http://images.amazon.com/images/P/0000913154.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0000913154.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0000913154.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>357256</th>\n",
       "      <td>86123</td>\n",
       "      <td>0001010565</td>\n",
       "      <td>0</td>\n",
       "      <td>Mog's Christmas</td>\n",
       "      <td>Judith Kerr</td>\n",
       "      <td>1992.0</td>\n",
       "      <td>Collins</td>\n",
       "      <td>http://images.amazon.com/images/P/0001010565.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0001010565.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0001010565.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>103677</th>\n",
       "      <td>23902</td>\n",
       "      <td>0001046438</td>\n",
       "      <td>9</td>\n",
       "      <td>Liar</td>\n",
       "      <td>Stephen Fry</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Harpercollins Uk</td>\n",
       "      <td>http://images.amazon.com/images/P/0001046438.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0001046438.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0001046438.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>807953</th>\n",
       "      <td>196149</td>\n",
       "      <td>0001046713</td>\n",
       "      <td>0</td>\n",
       "      <td>Twopence to Cross the Mersey</td>\n",
       "      <td>Helen Forrester</td>\n",
       "      <td>1992.0</td>\n",
       "      <td>HarperCollins Publishers</td>\n",
       "      <td>http://images.amazon.com/images/P/0001046713.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0001046713.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0001046713.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>103678</th>\n",
       "      <td>23902</td>\n",
       "      <td>000104687X</td>\n",
       "      <td>6</td>\n",
       "      <td>T.S. Eliot Reading \\The Wasteland\\\" and Other ...</td>\n",
       "      <td>T.S. Eliot</td>\n",
       "      <td>1993.0</td>\n",
       "      <td>HarperCollins Publishers</td>\n",
       "      <td>http://images.amazon.com/images/P/000104687X.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/000104687X.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/000104687X.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1100731</th>\n",
       "      <td>264317</td>\n",
       "      <td>B000234N76</td>\n",
       "      <td>0</td>\n",
       "      <td>Falling Angels</td>\n",
       "      <td>Tracy Chevalier</td>\n",
       "      <td>2001.0</td>\n",
       "      <td>E P Dutton</td>\n",
       "      <td>http://images.amazon.com/images/P/B000234N76.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/B000234N76.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/B000234N76.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>423108</th>\n",
       "      <td>100906</td>\n",
       "      <td>B000234NC6</td>\n",
       "      <td>0</td>\n",
       "      <td>It Must've Been Something I Ate: The Return of...</td>\n",
       "      <td>Jeffrey Steingarten</td>\n",
       "      <td>2002.0</td>\n",
       "      <td>Knopf</td>\n",
       "      <td>http://images.amazon.com/images/P/B000234NC6.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/B000234NC6.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/B000234NC6.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>419279</th>\n",
       "      <td>100088</td>\n",
       "      <td>B00029DGGO</td>\n",
       "      <td>0</td>\n",
       "      <td>Good Wife Strikes Back, The</td>\n",
       "      <td>Elizabeth Buchan</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Viking Adult</td>\n",
       "      <td>http://images.amazon.com/images/P/B00029DGGO.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/B00029DGGO.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/B00029DGGO.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>743545</th>\n",
       "      <td>179791</td>\n",
       "      <td>B0002JV9PY</td>\n",
       "      <td>0</td>\n",
       "      <td>The Blockade Runners</td>\n",
       "      <td>Jules Verne</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Digireads.com</td>\n",
       "      <td>http://images.amazon.com/images/P/B0002JV9PY.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/B0002JV9PY.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/B0002JV9PY.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>743546</th>\n",
       "      <td>179791</td>\n",
       "      <td>B0002K6K8O</td>\n",
       "      <td>0</td>\n",
       "      <td>The Underground City</td>\n",
       "      <td>Jules Verne</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Digireads.com</td>\n",
       "      <td>http://images.amazon.com/images/P/B0002K6K8O.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/B0002K6K8O.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/B0002K6K8O.0...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>270144 rows × 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         User-ID        ISBN  Book-Rating  \\\n",
       "703628    171118  0000913154            8   \n",
       "357256     86123  0001010565            0   \n",
       "103677     23902  0001046438            9   \n",
       "807953    196149  0001046713            0   \n",
       "103678     23902  000104687X            6   \n",
       "...          ...         ...          ...   \n",
       "1100731   264317  B000234N76            0   \n",
       "423108    100906  B000234NC6            0   \n",
       "419279    100088  B00029DGGO            0   \n",
       "743545    179791  B0002JV9PY            0   \n",
       "743546    179791  B0002K6K8O            0   \n",
       "\n",
       "                                                Book-Title  \\\n",
       "703628   The Way Things Work: An Illustrated Encycloped...   \n",
       "357256                                     Mog's Christmas   \n",
       "103677                                                Liar   \n",
       "807953                        Twopence to Cross the Mersey   \n",
       "103678   T.S. Eliot Reading \\The Wasteland\\\" and Other ...   \n",
       "...                                                    ...   \n",
       "1100731                                     Falling Angels   \n",
       "423108   It Must've Been Something I Ate: The Return of...   \n",
       "419279                         Good Wife Strikes Back, The   \n",
       "743545                                The Blockade Runners   \n",
       "743546                                The Underground City   \n",
       "\n",
       "                           Book-Author  Year-Of-Publication  \\\n",
       "703628   C. van Amerongen (translator)               1967.0   \n",
       "357256                     Judith Kerr               1992.0   \n",
       "103677                     Stephen Fry                  0.0   \n",
       "807953                 Helen Forrester               1992.0   \n",
       "103678                      T.S. Eliot               1993.0   \n",
       "...                                ...                  ...   \n",
       "1100731                Tracy Chevalier               2001.0   \n",
       "423108             Jeffrey Steingarten               2002.0   \n",
       "419279                Elizabeth Buchan                  0.0   \n",
       "743545                     Jules Verne                  0.0   \n",
       "743546                     Jules Verne                  0.0   \n",
       "\n",
       "                        Publisher  \\\n",
       "703628       Simon &amp; Schuster   \n",
       "357256                    Collins   \n",
       "103677           Harpercollins Uk   \n",
       "807953   HarperCollins Publishers   \n",
       "103678   HarperCollins Publishers   \n",
       "...                           ...   \n",
       "1100731                E P Dutton   \n",
       "423108                      Knopf   \n",
       "419279               Viking Adult   \n",
       "743545              Digireads.com   \n",
       "743546              Digireads.com   \n",
       "\n",
       "                                               Image-URL-S  \\\n",
       "703628   http://images.amazon.com/images/P/0000913154.0...   \n",
       "357256   http://images.amazon.com/images/P/0001010565.0...   \n",
       "103677   http://images.amazon.com/images/P/0001046438.0...   \n",
       "807953   http://images.amazon.com/images/P/0001046713.0...   \n",
       "103678   http://images.amazon.com/images/P/000104687X.0...   \n",
       "...                                                    ...   \n",
       "1100731  http://images.amazon.com/images/P/B000234N76.0...   \n",
       "423108   http://images.amazon.com/images/P/B000234NC6.0...   \n",
       "419279   http://images.amazon.com/images/P/B00029DGGO.0...   \n",
       "743545   http://images.amazon.com/images/P/B0002JV9PY.0...   \n",
       "743546   http://images.amazon.com/images/P/B0002K6K8O.0...   \n",
       "\n",
       "                                               Image-URL-M  \\\n",
       "703628   http://images.amazon.com/images/P/0000913154.0...   \n",
       "357256   http://images.amazon.com/images/P/0001010565.0...   \n",
       "103677   http://images.amazon.com/images/P/0001046438.0...   \n",
       "807953   http://images.amazon.com/images/P/0001046713.0...   \n",
       "103678   http://images.amazon.com/images/P/000104687X.0...   \n",
       "...                                                    ...   \n",
       "1100731  http://images.amazon.com/images/P/B000234N76.0...   \n",
       "423108   http://images.amazon.com/images/P/B000234NC6.0...   \n",
       "419279   http://images.amazon.com/images/P/B00029DGGO.0...   \n",
       "743545   http://images.amazon.com/images/P/B0002JV9PY.0...   \n",
       "743546   http://images.amazon.com/images/P/B0002K6K8O.0...   \n",
       "\n",
       "                                               Image-URL-L  \n",
       "703628   http://images.amazon.com/images/P/0000913154.0...  \n",
       "357256   http://images.amazon.com/images/P/0001010565.0...  \n",
       "103677   http://images.amazon.com/images/P/0001046438.0...  \n",
       "807953   http://images.amazon.com/images/P/0001046713.0...  \n",
       "103678   http://images.amazon.com/images/P/000104687X.0...  \n",
       "...                                                    ...  \n",
       "1100731  http://images.amazon.com/images/P/B000234N76.0...  \n",
       "423108   http://images.amazon.com/images/P/B000234NC6.0...  \n",
       "419279   http://images.amazon.com/images/P/B00029DGGO.0...  \n",
       "743545   http://images.amazon.com/images/P/B0002JV9PY.0...  \n",
       "743546   http://images.amazon.com/images/P/B0002K6K8O.0...  \n",
       "\n",
       "[270144 rows x 10 columns]"
      ]
     },
     "execution_count": 141,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "collaborative_books"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 142,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>User-ID</th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Rating</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>276725</td>\n",
       "      <td>034545104X</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>276726</td>\n",
       "      <td>0155061224</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>276727</td>\n",
       "      <td>0446520802</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>276729</td>\n",
       "      <td>052165615X</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>276729</td>\n",
       "      <td>0521795028</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19995</th>\n",
       "      <td>3757</td>\n",
       "      <td>843222264X</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19996</th>\n",
       "      <td>3757</td>\n",
       "      <td>8432222658</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19997</th>\n",
       "      <td>3757</td>\n",
       "      <td>8432222666</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19998</th>\n",
       "      <td>3757</td>\n",
       "      <td>8432222674</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19999</th>\n",
       "      <td>3757</td>\n",
       "      <td>8432222682</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>20000 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       User-ID        ISBN  Book-Rating\n",
       "0       276725  034545104X            0\n",
       "1       276726  0155061224            5\n",
       "2       276727  0446520802            0\n",
       "3       276729  052165615X            3\n",
       "4       276729  0521795028            6\n",
       "...        ...         ...          ...\n",
       "19995     3757  843222264X            7\n",
       "19996     3757  8432222658            7\n",
       "19997     3757  8432222666            7\n",
       "19998     3757  8432222674            7\n",
       "19999     3757  8432222682            6\n",
       "\n",
       "[20000 rows x 3 columns]"
      ]
     },
     "execution_count": 142,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_ratings_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 143,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Total ISBNs: 270144\n",
      "Total Titles: 270144\n",
      "Total Authors: 270144\n",
      "Total Publication Years: 270144\n",
      "Total Publishers: 270144\n"
     ]
    }
   ],
   "source": [
    "\n",
    "\n",
    "# Convert relevant columns to lists\n",
    "isbn_list = collaborative_books['ISBN'].tolist()\n",
    "title_list = collaborative_books['Book-Title'].tolist()\n",
    "author_list = collaborative_books['Book-Author'].tolist()\n",
    "year_list = collaborative_books['Year-Of-Publication'].tolist()\n",
    "publisher_list = collaborative_books['Publisher'].tolist()\n",
    "\n",
    "# Print the length of each list\n",
    "print(f\"Total ISBNs: {len(isbn_list)}\")\n",
    "print(f\"Total Titles: {len(title_list)}\")\n",
    "print(f\"Total Authors: {len(author_list)}\")\n",
    "print(f\"Total Publication Years: {len(year_list)}\")\n",
    "print(f\"Total Publishers: {len(publisher_list)}\")\n",
    "\n",
    "\n",
    "# Create a new DataFrame with different variable names\n",
    "new_books_df = pd.DataFrame({\n",
    "    'Unique_ISBN': isbn_list,\n",
    "    'Unique_Title': title_list,\n",
    "    'Unique_Author': author_list,\n",
    "    'Publication_Year_Unique': year_list,\n",
    "    'Unique_Publisher': publisher_list\n",
    "})\n",
    "\n",
    "# Select the first 20000 rows of the new DataFrame\n",
    "new_books_df = new_books_df[:20000]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 144,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unique_ISBN</th>\n",
       "      <th>Unique_Title</th>\n",
       "      <th>Unique_Author</th>\n",
       "      <th>Publication_Year_Unique</th>\n",
       "      <th>Unique_Publisher</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0000913154</td>\n",
       "      <td>The Way Things Work: An Illustrated Encycloped...</td>\n",
       "      <td>C. van Amerongen (translator)</td>\n",
       "      <td>1967.0</td>\n",
       "      <td>Simon &amp;amp; Schuster</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0001010565</td>\n",
       "      <td>Mog's Christmas</td>\n",
       "      <td>Judith Kerr</td>\n",
       "      <td>1992.0</td>\n",
       "      <td>Collins</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0001046438</td>\n",
       "      <td>Liar</td>\n",
       "      <td>Stephen Fry</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Harpercollins Uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0001046713</td>\n",
       "      <td>Twopence to Cross the Mersey</td>\n",
       "      <td>Helen Forrester</td>\n",
       "      <td>1992.0</td>\n",
       "      <td>HarperCollins Publishers</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>000104687X</td>\n",
       "      <td>T.S. Eliot Reading \\The Wasteland\\\" and Other ...</td>\n",
       "      <td>T.S. Eliot</td>\n",
       "      <td>1993.0</td>\n",
       "      <td>HarperCollins Publishers</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19995</th>\n",
       "      <td>0140444696</td>\n",
       "      <td>The Kreutzer Sonata and Other Stories (Penguin...</td>\n",
       "      <td>Leo Tolstoy</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>Penguin Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19996</th>\n",
       "      <td>014044470X</td>\n",
       "      <td>The Fiancee and Other Stories (Penguin Classics)</td>\n",
       "      <td>Anton Pavlovich Chekhov</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>Penguin Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19997</th>\n",
       "      <td>0140444726</td>\n",
       "      <td>Jacques the Fatalist and His Master (Penguin C...</td>\n",
       "      <td>Denis Diderot</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>Penguin Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19998</th>\n",
       "      <td>0140444742</td>\n",
       "      <td>Seven Viking Romances (Penguin Classics)</td>\n",
       "      <td>Hermann Palsson</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>Penguin Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19999</th>\n",
       "      <td>0140444750</td>\n",
       "      <td>Early Christian Writings: The Apostolic Father...</td>\n",
       "      <td>Maxwell Staniforth</td>\n",
       "      <td>1987.0</td>\n",
       "      <td>Penguin Books</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>20000 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Unique_ISBN                                       Unique_Title  \\\n",
       "0      0000913154  The Way Things Work: An Illustrated Encycloped...   \n",
       "1      0001010565                                    Mog's Christmas   \n",
       "2      0001046438                                               Liar   \n",
       "3      0001046713                       Twopence to Cross the Mersey   \n",
       "4      000104687X  T.S. Eliot Reading \\The Wasteland\\\" and Other ...   \n",
       "...           ...                                                ...   \n",
       "19995  0140444696  The Kreutzer Sonata and Other Stories (Penguin...   \n",
       "19996  014044470X   The Fiancee and Other Stories (Penguin Classics)   \n",
       "19997  0140444726  Jacques the Fatalist and His Master (Penguin C...   \n",
       "19998  0140444742           Seven Viking Romances (Penguin Classics)   \n",
       "19999  0140444750  Early Christian Writings: The Apostolic Father...   \n",
       "\n",
       "                       Unique_Author  Publication_Year_Unique  \\\n",
       "0      C. van Amerongen (translator)                   1967.0   \n",
       "1                        Judith Kerr                   1992.0   \n",
       "2                        Stephen Fry                      0.0   \n",
       "3                    Helen Forrester                   1992.0   \n",
       "4                         T.S. Eliot                   1993.0   \n",
       "...                              ...                      ...   \n",
       "19995                    Leo Tolstoy                   1986.0   \n",
       "19996        Anton Pavlovich Chekhov                   1986.0   \n",
       "19997                  Denis Diderot                   1986.0   \n",
       "19998                Hermann Palsson                   1986.0   \n",
       "19999             Maxwell Staniforth                   1987.0   \n",
       "\n",
       "               Unique_Publisher  \n",
       "0          Simon &amp; Schuster  \n",
       "1                       Collins  \n",
       "2              Harpercollins Uk  \n",
       "3      HarperCollins Publishers  \n",
       "4      HarperCollins Publishers  \n",
       "...                         ...  \n",
       "19995             Penguin Books  \n",
       "19996             Penguin Books  \n",
       "19997             Penguin Books  \n",
       "19998             Penguin Books  \n",
       "19999             Penguin Books  \n",
       "\n",
       "[20000 rows x 5 columns]"
      ]
     },
     "execution_count": 144,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_books_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 145,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Extract unique User-IDs from the final_ratings_df DataFrame and convert to a list\n",
    "unique_user_ids = final_ratings_df['User-ID'].unique().tolist()\n",
    "\n",
    "# Perform User-ID encoding\n",
    "encoded_user = {user_id: index for index, user_id in enumerate(unique_user_ids)}\n",
    "\n",
    "# Reverse the encoding process to map encoded numbers back to User-IDs\n",
    "user_encoded_to_user = {index: user_id for index, user_id in enumerate(unique_user_ids)}\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 146,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/1d/7ynr__411fx9qj9r1bgh72cc0000gn/T/ipykernel_7568/412158009.py:11: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  final_ratings_df['user'] = final_ratings_df['User-ID'].map(encoded_user)\n",
      "/var/folders/1d/7ynr__411fx9qj9r1bgh72cc0000gn/T/ipykernel_7568/412158009.py:14: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  final_ratings_df['book_title'] = final_ratings_df['ISBN'].map(isbn_to_isbn_encoded)\n"
     ]
    }
   ],
   "source": [
    "# Extract unique ISBNs from the final_ratings_df DataFrame and convert to a list\n",
    "unique_isbns = final_ratings_df['ISBN'].unique().tolist()\n",
    "\n",
    "# Perform ISBN encoding\n",
    "isbn_to_isbn_encoded = {isbn: index for index, isbn in enumerate(unique_isbns)}\n",
    "\n",
    "# Reverse the encoding process to map encoded numbers back to ISBNs\n",
    "isbn_encoded_to_isbn = {index: isbn for index, isbn in enumerate(unique_isbns)}\n",
    "\n",
    "# Mapping User-ID to user dataframe\n",
    "final_ratings_df['user'] = final_ratings_df['User-ID'].map(encoded_user)\n",
    "\n",
    "# Mapping ISBN to book title dataframe\n",
    "final_ratings_df['book_title'] = final_ratings_df['ISBN'].map(isbn_to_isbn_encoded)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 184,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>User-ID</th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Rating</th>\n",
       "      <th>user</th>\n",
       "      <th>book_title</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>10650</th>\n",
       "      <td>446</td>\n",
       "      <td>0061000280</td>\n",
       "      <td>10.0</td>\n",
       "      <td>1005</td>\n",
       "      <td>9861</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2041</th>\n",
       "      <td>277478</td>\n",
       "      <td>0340565276</td>\n",
       "      <td>8.0</td>\n",
       "      <td>273</td>\n",
       "      <td>1978</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8668</th>\n",
       "      <td>278418</td>\n",
       "      <td>1569751544</td>\n",
       "      <td>3.0</td>\n",
       "      <td>678</td>\n",
       "      <td>8223</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1114</th>\n",
       "      <td>277195</td>\n",
       "      <td>0394726413</td>\n",
       "      <td>0.0</td>\n",
       "      <td>173</td>\n",
       "      <td>1098</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13902</th>\n",
       "      <td>1928</td>\n",
       "      <td>0373196903</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1511</td>\n",
       "      <td>12430</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11284</th>\n",
       "      <td>651</td>\n",
       "      <td>1888451084</td>\n",
       "      <td>7.0</td>\n",
       "      <td>1071</td>\n",
       "      <td>10381</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11964</th>\n",
       "      <td>929</td>\n",
       "      <td>0345331605</td>\n",
       "      <td>7.0</td>\n",
       "      <td>1163</td>\n",
       "      <td>10917</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5390</th>\n",
       "      <td>278418</td>\n",
       "      <td>0373121962</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>5066</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>860</th>\n",
       "      <td>277087</td>\n",
       "      <td>8472230082</td>\n",
       "      <td>5.0</td>\n",
       "      <td>139</td>\n",
       "      <td>850</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15795</th>\n",
       "      <td>2442</td>\n",
       "      <td>8804320095</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1706</td>\n",
       "      <td>13939</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>20000 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       User-ID        ISBN  Book-Rating  user  book_title\n",
       "10650      446  0061000280         10.0  1005        9861\n",
       "2041    277478  0340565276          8.0   273        1978\n",
       "8668    278418  1569751544          3.0   678        8223\n",
       "1114    277195  0394726413          0.0   173        1098\n",
       "13902     1928  0373196903          0.0  1511       12430\n",
       "...        ...         ...          ...   ...         ...\n",
       "11284      651  1888451084          7.0  1071       10381\n",
       "11964      929  0345331605          7.0  1163       10917\n",
       "5390    278418  0373121962          0.0   678        5066\n",
       "860     277087  8472230082          5.0   139         850\n",
       "15795     2442  8804320095          0.0  1706       13939\n",
       "\n",
       "[20000 rows x 5 columns]"
      ]
     },
     "execution_count": 184,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_ratings_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 147,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Number of Users: 2180\n",
      "Number of Book Titles: 17178\n",
      "Number of Users: 2180, Number of Books: 17178, Min Rating: 0.0, Max Rating: 10.0\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/1d/7ynr__411fx9qj9r1bgh72cc0000gn/T/ipykernel_7568/698996732.py:10: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  final_ratings_df['Book-Rating'] = final_ratings_df['Book-Rating'].values.astype(np.float32)\n"
     ]
    }
   ],
   "source": [
    "# Get the number of users\n",
    "num_users = len(encoded_user)\n",
    "print(f\"Number of Users: {num_users}\")\n",
    "\n",
    "# Get the number of book titles\n",
    "num_book_titles = len(isbn_to_isbn_encoded)\n",
    "print(f\"Number of Book Titles: {num_book_titles}\")\n",
    "\n",
    "# Convert the 'Book-Rating' to a float value\n",
    "final_ratings_df['Book-Rating'] = final_ratings_df['Book-Rating'].values.astype(np.float32)\n",
    "\n",
    "# Minimum rating value\n",
    "min_rating = min(final_ratings_df['Book-Rating'])\n",
    "\n",
    "# Maximum rating value\n",
    "max_rating = max(final_ratings_df['Book-Rating'])\n",
    "\n",
    "print(f\"Number of Users: {num_users}, Number of Books: {num_book_titles}, Min Rating: {min_rating}, Max Rating: {max_rating}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 183,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>User-ID</th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Rating</th>\n",
       "      <th>user</th>\n",
       "      <th>book_title</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>10650</th>\n",
       "      <td>446</td>\n",
       "      <td>0061000280</td>\n",
       "      <td>10.0</td>\n",
       "      <td>1005</td>\n",
       "      <td>9861</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2041</th>\n",
       "      <td>277478</td>\n",
       "      <td>0340565276</td>\n",
       "      <td>8.0</td>\n",
       "      <td>273</td>\n",
       "      <td>1978</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8668</th>\n",
       "      <td>278418</td>\n",
       "      <td>1569751544</td>\n",
       "      <td>3.0</td>\n",
       "      <td>678</td>\n",
       "      <td>8223</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1114</th>\n",
       "      <td>277195</td>\n",
       "      <td>0394726413</td>\n",
       "      <td>0.0</td>\n",
       "      <td>173</td>\n",
       "      <td>1098</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13902</th>\n",
       "      <td>1928</td>\n",
       "      <td>0373196903</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1511</td>\n",
       "      <td>12430</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11284</th>\n",
       "      <td>651</td>\n",
       "      <td>1888451084</td>\n",
       "      <td>7.0</td>\n",
       "      <td>1071</td>\n",
       "      <td>10381</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11964</th>\n",
       "      <td>929</td>\n",
       "      <td>0345331605</td>\n",
       "      <td>7.0</td>\n",
       "      <td>1163</td>\n",
       "      <td>10917</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5390</th>\n",
       "      <td>278418</td>\n",
       "      <td>0373121962</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>5066</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>860</th>\n",
       "      <td>277087</td>\n",
       "      <td>8472230082</td>\n",
       "      <td>5.0</td>\n",
       "      <td>139</td>\n",
       "      <td>850</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15795</th>\n",
       "      <td>2442</td>\n",
       "      <td>8804320095</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1706</td>\n",
       "      <td>13939</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>20000 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       User-ID        ISBN  Book-Rating  user  book_title\n",
       "10650      446  0061000280         10.0  1005        9861\n",
       "2041    277478  0340565276          8.0   273        1978\n",
       "8668    278418  1569751544          3.0   678        8223\n",
       "1114    277195  0394726413          0.0   173        1098\n",
       "13902     1928  0373196903          0.0  1511       12430\n",
       "...        ...         ...          ...   ...         ...\n",
       "11284      651  1888451084          7.0  1071       10381\n",
       "11964      929  0345331605          7.0  1163       10917\n",
       "5390    278418  0373121962          0.0   678        5066\n",
       "860     277087  8472230082          5.0   139         850\n",
       "15795     2442  8804320095          0.0  1706       13939\n",
       "\n",
       "[20000 rows x 5 columns]"
      ]
     },
     "execution_count": 183,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_ratings_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 148,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unique_ISBN</th>\n",
       "      <th>Unique_Title</th>\n",
       "      <th>Unique_Author</th>\n",
       "      <th>Publication_Year_Unique</th>\n",
       "      <th>Unique_Publisher</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0000913154</td>\n",
       "      <td>The Way Things Work: An Illustrated Encycloped...</td>\n",
       "      <td>C. van Amerongen (translator)</td>\n",
       "      <td>1967.0</td>\n",
       "      <td>Simon &amp;amp; Schuster</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0001010565</td>\n",
       "      <td>Mog's Christmas</td>\n",
       "      <td>Judith Kerr</td>\n",
       "      <td>1992.0</td>\n",
       "      <td>Collins</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0001046438</td>\n",
       "      <td>Liar</td>\n",
       "      <td>Stephen Fry</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Harpercollins Uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0001046713</td>\n",
       "      <td>Twopence to Cross the Mersey</td>\n",
       "      <td>Helen Forrester</td>\n",
       "      <td>1992.0</td>\n",
       "      <td>HarperCollins Publishers</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>000104687X</td>\n",
       "      <td>T.S. Eliot Reading \\The Wasteland\\\" and Other ...</td>\n",
       "      <td>T.S. Eliot</td>\n",
       "      <td>1993.0</td>\n",
       "      <td>HarperCollins Publishers</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19995</th>\n",
       "      <td>0140444696</td>\n",
       "      <td>The Kreutzer Sonata and Other Stories (Penguin...</td>\n",
       "      <td>Leo Tolstoy</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>Penguin Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19996</th>\n",
       "      <td>014044470X</td>\n",
       "      <td>The Fiancee and Other Stories (Penguin Classics)</td>\n",
       "      <td>Anton Pavlovich Chekhov</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>Penguin Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19997</th>\n",
       "      <td>0140444726</td>\n",
       "      <td>Jacques the Fatalist and His Master (Penguin C...</td>\n",
       "      <td>Denis Diderot</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>Penguin Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19998</th>\n",
       "      <td>0140444742</td>\n",
       "      <td>Seven Viking Romances (Penguin Classics)</td>\n",
       "      <td>Hermann Palsson</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>Penguin Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19999</th>\n",
       "      <td>0140444750</td>\n",
       "      <td>Early Christian Writings: The Apostolic Father...</td>\n",
       "      <td>Maxwell Staniforth</td>\n",
       "      <td>1987.0</td>\n",
       "      <td>Penguin Books</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>20000 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Unique_ISBN                                       Unique_Title  \\\n",
       "0      0000913154  The Way Things Work: An Illustrated Encycloped...   \n",
       "1      0001010565                                    Mog's Christmas   \n",
       "2      0001046438                                               Liar   \n",
       "3      0001046713                       Twopence to Cross the Mersey   \n",
       "4      000104687X  T.S. Eliot Reading \\The Wasteland\\\" and Other ...   \n",
       "...           ...                                                ...   \n",
       "19995  0140444696  The Kreutzer Sonata and Other Stories (Penguin...   \n",
       "19996  014044470X   The Fiancee and Other Stories (Penguin Classics)   \n",
       "19997  0140444726  Jacques the Fatalist and His Master (Penguin C...   \n",
       "19998  0140444742           Seven Viking Romances (Penguin Classics)   \n",
       "19999  0140444750  Early Christian Writings: The Apostolic Father...   \n",
       "\n",
       "                       Unique_Author  Publication_Year_Unique  \\\n",
       "0      C. van Amerongen (translator)                   1967.0   \n",
       "1                        Judith Kerr                   1992.0   \n",
       "2                        Stephen Fry                      0.0   \n",
       "3                    Helen Forrester                   1992.0   \n",
       "4                         T.S. Eliot                   1993.0   \n",
       "...                              ...                      ...   \n",
       "19995                    Leo Tolstoy                   1986.0   \n",
       "19996        Anton Pavlovich Chekhov                   1986.0   \n",
       "19997                  Denis Diderot                   1986.0   \n",
       "19998                Hermann Palsson                   1986.0   \n",
       "19999             Maxwell Staniforth                   1987.0   \n",
       "\n",
       "               Unique_Publisher  \n",
       "0          Simon &amp; Schuster  \n",
       "1                       Collins  \n",
       "2              Harpercollins Uk  \n",
       "3      HarperCollins Publishers  \n",
       "4      HarperCollins Publishers  \n",
       "...                         ...  \n",
       "19995             Penguin Books  \n",
       "19996             Penguin Books  \n",
       "19997             Penguin Books  \n",
       "19998             Penguin Books  \n",
       "19999             Penguin Books  \n",
       "\n",
       "[20000 rows x 5 columns]"
      ]
     },
     "execution_count": 148,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_books_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 182,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>User-ID</th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Rating</th>\n",
       "      <th>user</th>\n",
       "      <th>book_title</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>10650</th>\n",
       "      <td>446</td>\n",
       "      <td>0061000280</td>\n",
       "      <td>10.0</td>\n",
       "      <td>1005</td>\n",
       "      <td>9861</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2041</th>\n",
       "      <td>277478</td>\n",
       "      <td>0340565276</td>\n",
       "      <td>8.0</td>\n",
       "      <td>273</td>\n",
       "      <td>1978</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8668</th>\n",
       "      <td>278418</td>\n",
       "      <td>1569751544</td>\n",
       "      <td>3.0</td>\n",
       "      <td>678</td>\n",
       "      <td>8223</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1114</th>\n",
       "      <td>277195</td>\n",
       "      <td>0394726413</td>\n",
       "      <td>0.0</td>\n",
       "      <td>173</td>\n",
       "      <td>1098</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13902</th>\n",
       "      <td>1928</td>\n",
       "      <td>0373196903</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1511</td>\n",
       "      <td>12430</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11284</th>\n",
       "      <td>651</td>\n",
       "      <td>1888451084</td>\n",
       "      <td>7.0</td>\n",
       "      <td>1071</td>\n",
       "      <td>10381</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11964</th>\n",
       "      <td>929</td>\n",
       "      <td>0345331605</td>\n",
       "      <td>7.0</td>\n",
       "      <td>1163</td>\n",
       "      <td>10917</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5390</th>\n",
       "      <td>278418</td>\n",
       "      <td>0373121962</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>5066</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>860</th>\n",
       "      <td>277087</td>\n",
       "      <td>8472230082</td>\n",
       "      <td>5.0</td>\n",
       "      <td>139</td>\n",
       "      <td>850</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15795</th>\n",
       "      <td>2442</td>\n",
       "      <td>8804320095</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1706</td>\n",
       "      <td>13939</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>20000 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       User-ID        ISBN  Book-Rating  user  book_title\n",
       "10650      446  0061000280         10.0  1005        9861\n",
       "2041    277478  0340565276          8.0   273        1978\n",
       "8668    278418  1569751544          3.0   678        8223\n",
       "1114    277195  0394726413          0.0   173        1098\n",
       "13902     1928  0373196903          0.0  1511       12430\n",
       "...        ...         ...          ...   ...         ...\n",
       "11284      651  1888451084          7.0  1071       10381\n",
       "11964      929  0345331605          7.0  1163       10917\n",
       "5390    278418  0373121962          0.0   678        5066\n",
       "860     277087  8472230082          5.0   139         850\n",
       "15795     2442  8804320095          0.0  1706       13939\n",
       "\n",
       "[20000 rows x 5 columns]"
      ]
     },
     "execution_count": 182,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_ratings_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 149,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Randomly reorganize the entries in the final_ratings_df DataFrame\n",
    "final_ratings_df = final_ratings_df.sample(frac=1, random_state=42)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 150,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[ 1005  9861]\n",
      " [  273  1978]\n",
      " [  678  8223]\n",
      " ...\n",
      " [  678  5066]\n",
      " [  139   850]\n",
      " [ 1706 13939]] [1.  0.8 0.3 ... 0.  0.5 0. ]\n"
     ]
    }
   ],
   "source": [
    "# create a variable x to match user data and book title into one value\n",
    "x = final_ratings_df[['user', 'book_title']].values\n",
    "\n",
    "# create a y variable to create a rating of the results\n",
    "y = final_ratings_df['Book-Rating'].apply(lambda x: (x - min_rating) / (max_rating - min_rating)).values\n",
    "\n",
    "# divide into 90% train data and 10% validation data\n",
    "\n",
    "train_indices = int(0.9 * final_ratings_df.shape[0])\n",
    "x_train, x_val, y_train, y_val = (\n",
    "     x[:train_indices],\n",
    "     x[train_indices:],\n",
    "     y[:train_indices],\n",
    "     y[train_indices:]\n",
    ")\n",
    "\n",
    "print(x, y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 179,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>User-ID</th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Rating</th>\n",
       "      <th>user</th>\n",
       "      <th>book_title</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>10650</th>\n",
       "      <td>446</td>\n",
       "      <td>0061000280</td>\n",
       "      <td>10.0</td>\n",
       "      <td>1005</td>\n",
       "      <td>9861</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2041</th>\n",
       "      <td>277478</td>\n",
       "      <td>0340565276</td>\n",
       "      <td>8.0</td>\n",
       "      <td>273</td>\n",
       "      <td>1978</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8668</th>\n",
       "      <td>278418</td>\n",
       "      <td>1569751544</td>\n",
       "      <td>3.0</td>\n",
       "      <td>678</td>\n",
       "      <td>8223</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1114</th>\n",
       "      <td>277195</td>\n",
       "      <td>0394726413</td>\n",
       "      <td>0.0</td>\n",
       "      <td>173</td>\n",
       "      <td>1098</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13902</th>\n",
       "      <td>1928</td>\n",
       "      <td>0373196903</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1511</td>\n",
       "      <td>12430</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11284</th>\n",
       "      <td>651</td>\n",
       "      <td>1888451084</td>\n",
       "      <td>7.0</td>\n",
       "      <td>1071</td>\n",
       "      <td>10381</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11964</th>\n",
       "      <td>929</td>\n",
       "      <td>0345331605</td>\n",
       "      <td>7.0</td>\n",
       "      <td>1163</td>\n",
       "      <td>10917</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5390</th>\n",
       "      <td>278418</td>\n",
       "      <td>0373121962</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>5066</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>860</th>\n",
       "      <td>277087</td>\n",
       "      <td>8472230082</td>\n",
       "      <td>5.0</td>\n",
       "      <td>139</td>\n",
       "      <td>850</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15795</th>\n",
       "      <td>2442</td>\n",
       "      <td>8804320095</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1706</td>\n",
       "      <td>13939</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>20000 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       User-ID        ISBN  Book-Rating  user  book_title\n",
       "10650      446  0061000280         10.0  1005        9861\n",
       "2041    277478  0340565276          8.0   273        1978\n",
       "8668    278418  1569751544          3.0   678        8223\n",
       "1114    277195  0394726413          0.0   173        1098\n",
       "13902     1928  0373196903          0.0  1511       12430\n",
       "...        ...         ...          ...   ...         ...\n",
       "11284      651  1888451084          7.0  1071       10381\n",
       "11964      929  0345331605          7.0  1163       10917\n",
       "5390    278418  0373121962          0.0   678        5066\n",
       "860     277087  8472230082          5.0   139         850\n",
       "15795     2442  8804320095          0.0  1706       13939\n",
       "\n",
       "[20000 rows x 5 columns]"
      ]
     },
     "execution_count": 179,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_ratings_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 181,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Year-Of-Publication</th>\n",
       "      <th>Publisher</th>\n",
       "      <th>Image-URL-S</th>\n",
       "      <th>Image-URL-M</th>\n",
       "      <th>Image-URL-L</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0195153448</td>\n",
       "      <td>Classical Mythology</td>\n",
       "      <td>Mark P. O. Morford</td>\n",
       "      <td>2002</td>\n",
       "      <td>Oxford University Press</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0002005018</td>\n",
       "      <td>Clara Callan</td>\n",
       "      <td>Richard Bruce Wright</td>\n",
       "      <td>2001</td>\n",
       "      <td>HarperFlamingo Canada</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0060973129</td>\n",
       "      <td>Decision in Normandy</td>\n",
       "      <td>Carlo D'Este</td>\n",
       "      <td>1991</td>\n",
       "      <td>HarperPerennial</td>\n",
       "      <td>http://images.amazon.com/images/P/0060973129.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0060973129.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0060973129.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0374157065</td>\n",
       "      <td>Flu: The Story of the Great Influenza Pandemic...</td>\n",
       "      <td>Gina Bari Kolata</td>\n",
       "      <td>1999</td>\n",
       "      <td>Farrar Straus Giroux</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0393045218</td>\n",
       "      <td>The Mummies of Urumchi</td>\n",
       "      <td>E. J. W. Barber</td>\n",
       "      <td>1999</td>\n",
       "      <td>W. W. Norton &amp;amp; Company</td>\n",
       "      <td>http://images.amazon.com/images/P/0393045218.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0393045218.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0393045218.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271355</th>\n",
       "      <td>0440400988</td>\n",
       "      <td>There's a Bat in Bunk Five</td>\n",
       "      <td>Paula Danziger</td>\n",
       "      <td>1988</td>\n",
       "      <td>Random House Childrens Pub (Mm)</td>\n",
       "      <td>http://images.amazon.com/images/P/0440400988.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0440400988.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0440400988.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271356</th>\n",
       "      <td>0525447644</td>\n",
       "      <td>From One to One Hundred</td>\n",
       "      <td>Teri Sloat</td>\n",
       "      <td>1991</td>\n",
       "      <td>Dutton Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0525447644.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0525447644.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0525447644.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271357</th>\n",
       "      <td>006008667X</td>\n",
       "      <td>Lily Dale : The True Story of the Town that Ta...</td>\n",
       "      <td>Christine Wicker</td>\n",
       "      <td>2004</td>\n",
       "      <td>HarperSanFrancisco</td>\n",
       "      <td>http://images.amazon.com/images/P/006008667X.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/006008667X.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/006008667X.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271358</th>\n",
       "      <td>0192126040</td>\n",
       "      <td>Republic (World's Classics)</td>\n",
       "      <td>Plato</td>\n",
       "      <td>1996</td>\n",
       "      <td>Oxford University Press</td>\n",
       "      <td>http://images.amazon.com/images/P/0192126040.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0192126040.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0192126040.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271359</th>\n",
       "      <td>0767409752</td>\n",
       "      <td>A Guided Tour of Rene Descartes' Meditations o...</td>\n",
       "      <td>Christopher  Biffle</td>\n",
       "      <td>2000</td>\n",
       "      <td>McGraw-Hill Humanities/Social Sciences/Languages</td>\n",
       "      <td>http://images.amazon.com/images/P/0767409752.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0767409752.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0767409752.0...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>271357 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              ISBN                                         Book-Title  \\\n",
       "0       0195153448                                Classical Mythology   \n",
       "1       0002005018                                       Clara Callan   \n",
       "2       0060973129                               Decision in Normandy   \n",
       "3       0374157065  Flu: The Story of the Great Influenza Pandemic...   \n",
       "4       0393045218                             The Mummies of Urumchi   \n",
       "...            ...                                                ...   \n",
       "271355  0440400988                         There's a Bat in Bunk Five   \n",
       "271356  0525447644                            From One to One Hundred   \n",
       "271357  006008667X  Lily Dale : The True Story of the Town that Ta...   \n",
       "271358  0192126040                        Republic (World's Classics)   \n",
       "271359  0767409752  A Guided Tour of Rene Descartes' Meditations o...   \n",
       "\n",
       "                 Book-Author  Year-Of-Publication  \\\n",
       "0         Mark P. O. Morford                 2002   \n",
       "1       Richard Bruce Wright                 2001   \n",
       "2               Carlo D'Este                 1991   \n",
       "3           Gina Bari Kolata                 1999   \n",
       "4            E. J. W. Barber                 1999   \n",
       "...                      ...                  ...   \n",
       "271355        Paula Danziger                 1988   \n",
       "271356            Teri Sloat                 1991   \n",
       "271357      Christine Wicker                 2004   \n",
       "271358                 Plato                 1996   \n",
       "271359   Christopher  Biffle                 2000   \n",
       "\n",
       "                                               Publisher  \\\n",
       "0                                Oxford University Press   \n",
       "1                                  HarperFlamingo Canada   \n",
       "2                                        HarperPerennial   \n",
       "3                                   Farrar Straus Giroux   \n",
       "4                             W. W. Norton &amp; Company   \n",
       "...                                                  ...   \n",
       "271355                   Random House Childrens Pub (Mm)   \n",
       "271356                                      Dutton Books   \n",
       "271357                                HarperSanFrancisco   \n",
       "271358                           Oxford University Press   \n",
       "271359  McGraw-Hill Humanities/Social Sciences/Languages   \n",
       "\n",
       "                                              Image-URL-S  \\\n",
       "0       http://images.amazon.com/images/P/0195153448.0...   \n",
       "1       http://images.amazon.com/images/P/0002005018.0...   \n",
       "2       http://images.amazon.com/images/P/0060973129.0...   \n",
       "3       http://images.amazon.com/images/P/0374157065.0...   \n",
       "4       http://images.amazon.com/images/P/0393045218.0...   \n",
       "...                                                   ...   \n",
       "271355  http://images.amazon.com/images/P/0440400988.0...   \n",
       "271356  http://images.amazon.com/images/P/0525447644.0...   \n",
       "271357  http://images.amazon.com/images/P/006008667X.0...   \n",
       "271358  http://images.amazon.com/images/P/0192126040.0...   \n",
       "271359  http://images.amazon.com/images/P/0767409752.0...   \n",
       "\n",
       "                                              Image-URL-M  \\\n",
       "0       http://images.amazon.com/images/P/0195153448.0...   \n",
       "1       http://images.amazon.com/images/P/0002005018.0...   \n",
       "2       http://images.amazon.com/images/P/0060973129.0...   \n",
       "3       http://images.amazon.com/images/P/0374157065.0...   \n",
       "4       http://images.amazon.com/images/P/0393045218.0...   \n",
       "...                                                   ...   \n",
       "271355  http://images.amazon.com/images/P/0440400988.0...   \n",
       "271356  http://images.amazon.com/images/P/0525447644.0...   \n",
       "271357  http://images.amazon.com/images/P/006008667X.0...   \n",
       "271358  http://images.amazon.com/images/P/0192126040.0...   \n",
       "271359  http://images.amazon.com/images/P/0767409752.0...   \n",
       "\n",
       "                                              Image-URL-L  \n",
       "0       http://images.amazon.com/images/P/0195153448.0...  \n",
       "1       http://images.amazon.com/images/P/0002005018.0...  \n",
       "2       http://images.amazon.com/images/P/0060973129.0...  \n",
       "3       http://images.amazon.com/images/P/0374157065.0...  \n",
       "4       http://images.amazon.com/images/P/0393045218.0...  \n",
       "...                                                   ...  \n",
       "271355  http://images.amazon.com/images/P/0440400988.0...  \n",
       "271356  http://images.amazon.com/images/P/0525447644.0...  \n",
       "271357  http://images.amazon.com/images/P/006008667X.0...  \n",
       "271358  http://images.amazon.com/images/P/0192126040.0...  \n",
       "271359  http://images.amazon.com/images/P/0767409752.0...  \n",
       "\n",
       "[271357 rows x 8 columns]"
      ]
     },
     "execution_count": 181,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 151,
   "metadata": {},
   "outputs": [],
   "source": [
    "import tensorflow as tf\n",
    "from tensorflow import keras\n",
    "from tensorflow.keras import layers\n",
    "\n",
    "class PersonalizedRecommender(keras.Model):\n",
    "    \"\"\"\n",
    "    Neural network-based personalized recommender system.\n",
    "    \"\"\"\n",
    "\n",
    "    def __init__(self, num_users, num_items, embedding_size, dropout_rate=0.3, **kwargs):\n",
    "        \"\"\"\n",
    "        Initialize the PersonalizedRecommender model.\n",
    "\n",
    "        Parameters:\n",
    "        - num_users: Number of users in the dataset.\n",
    "        - num_items: Number of unique items in the dataset.\n",
    "        - embedding_size: Size of the embedding vectors.\n",
    "        - dropout_rate: Dropout rate for regularization.\n",
    "        \"\"\"\n",
    "        super(PersonalizedRecommender, self).__init__(**kwargs)\n",
    "\n",
    "        # Model parameters\n",
    "        self.num_users = num_users\n",
    "        self.num_items = num_items\n",
    "        self.embedding_size = embedding_size\n",
    "        self.dropout_rate = dropout_rate\n",
    "\n",
    "        # User embedding layer\n",
    "        self.user_embedding = layers.Embedding(\n",
    "            num_users,\n",
    "            embedding_size,\n",
    "            embeddings_initializer='glorot_normal',\n",
    "            embeddings_regularizer=keras.regularizers.l2(1e-6)\n",
    "        )\n",
    "\n",
    "        # User bias embedding layer\n",
    "        self.user_bias = layers.Embedding(num_users, 1)\n",
    "\n",
    "        # Item embedding layer\n",
    "        self.item_embedding = layers.Embedding(\n",
    "            num_items,\n",
    "            embedding_size,\n",
    "            embeddings_initializer='glorot_normal',\n",
    "            embeddings_regularizer=keras.regularizers.l2(1e-6)\n",
    "        )\n",
    "\n",
    "        # Item bias embedding layer\n",
    "        self.item_bias = layers.Embedding(num_items, 1)\n",
    "\n",
    "        # Dropout layer\n",
    "        self.dropout = layers.Dropout(rate=dropout_rate)\n",
    "\n",
    "    def call(self, inputs):\n",
    "        \"\"\"\n",
    "        Forward pass of the model.\n",
    "\n",
    "        Parameters:\n",
    "        - inputs: Input tensor containing user and item indices.\n",
    "\n",
    "        Returns:\n",
    "        - Output tensor representing the predicted interaction.\n",
    "        \"\"\"\n",
    "        # User embedding layer\n",
    "        user_vector = self.user_embedding(inputs[:, 0])\n",
    "        user_vector = self.dropout(user_vector)\n",
    "\n",
    "        # User bias embedding layer\n",
    "        user_bias = self.user_bias(inputs[:, 0])\n",
    "\n",
    "        # Item embedding layer\n",
    "        item_vector = self.item_embedding(inputs[:, 1])\n",
    "        item_vector = self.dropout(item_vector)\n",
    "\n",
    "        # Item bias embedding layer\n",
    "        item_bias = self.item_bias(inputs[:, 1])\n",
    "\n",
    "        # Dot product interaction\n",
    "        interaction = tf.tensordot(user_vector, item_vector, 2)\n",
    "\n",
    "        # Combine components\n",
    "        x = interaction + user_bias + item_bias\n",
    "\n",
    "        # Sigmoid activation\n",
    "        return tf.nn.sigmoid(x)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 152,
   "metadata": {},
   "outputs": [],
   "source": [
    "# New model\n",
    "recommendation_model = PersonalizedRecommender(num_users, num_book_titles, embedding_size=50)\n",
    "# Compile the model\n",
    "recommendation_model.compile(\n",
    "    loss=keras.losses.BinaryCrossentropy(),\n",
    "    optimizer=keras.optimizers.Adam(learning_rate=1e-4),\n",
    "    metrics=[keras.metrics.RootMeanSquaredError()]\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 131,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1/50\n",
      " 895/1125 [======================>.......] - ETA: 1s - loss: 0.6864 - root_mean_squared_error: 0.4378"
     ]
    },
    {
     "ename": "KeyboardInterrupt",
     "evalue": "",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
      "Cell \u001b[0;32mIn[131], line 3\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[38;5;66;03m# start the training process\u001b[39;00m\n\u001b[0;32m----> 3\u001b[0m history \u001b[38;5;241m=\u001b[39m recommendation_model\u001b[38;5;241m.\u001b[39mfit(\n\u001b[1;32m      4\u001b[0m     x \u001b[38;5;241m=\u001b[39m x_train,\n\u001b[1;32m      5\u001b[0m     y \u001b[38;5;241m=\u001b[39m y_train,\n\u001b[1;32m      6\u001b[0m     batch_size \u001b[38;5;241m=\u001b[39m \u001b[38;5;241m16\u001b[39m,\n\u001b[1;32m      7\u001b[0m     epochs \u001b[38;5;241m=\u001b[39m \u001b[38;5;241m50\u001b[39m,\n\u001b[1;32m      8\u001b[0m     validation_data \u001b[38;5;241m=\u001b[39m (x_val, y_val)\n\u001b[1;32m      9\u001b[0m )\n",
      "File \u001b[0;32m~/miniconda3/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py:65\u001b[0m, in \u001b[0;36mfilter_traceback.<locals>.error_handler\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m     63\u001b[0m filtered_tb \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[1;32m     64\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[0;32m---> 65\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m fn(\u001b[38;5;241m*\u001b[39margs, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs)\n\u001b[1;32m     66\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mException\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m e:\n\u001b[1;32m     67\u001b[0m     filtered_tb \u001b[38;5;241m=\u001b[39m _process_traceback_frames(e\u001b[38;5;241m.\u001b[39m__traceback__)\n",
      "File \u001b[0;32m~/miniconda3/lib/python3.11/site-packages/keras/src/engine/training.py:1813\u001b[0m, in \u001b[0;36mModel.fit\u001b[0;34m(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_batch_size, validation_freq, max_queue_size, workers, use_multiprocessing)\u001b[0m\n\u001b[1;32m   1811\u001b[0m logs \u001b[38;5;241m=\u001b[39m tmp_logs\n\u001b[1;32m   1812\u001b[0m end_step \u001b[38;5;241m=\u001b[39m step \u001b[38;5;241m+\u001b[39m data_handler\u001b[38;5;241m.\u001b[39mstep_increment\n\u001b[0;32m-> 1813\u001b[0m callbacks\u001b[38;5;241m.\u001b[39mon_train_batch_end(end_step, logs)\n\u001b[1;32m   1814\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mstop_training:\n\u001b[1;32m   1815\u001b[0m     \u001b[38;5;28;01mbreak\u001b[39;00m\n",
      "File \u001b[0;32m~/miniconda3/lib/python3.11/site-packages/keras/src/callbacks.py:475\u001b[0m, in \u001b[0;36mCallbackList.on_train_batch_end\u001b[0;34m(self, batch, logs)\u001b[0m\n\u001b[1;32m    468\u001b[0m \u001b[38;5;250m\u001b[39m\u001b[38;5;124;03m\"\"\"Calls the `on_train_batch_end` methods of its callbacks.\u001b[39;00m\n\u001b[1;32m    469\u001b[0m \n\u001b[1;32m    470\u001b[0m \u001b[38;5;124;03mArgs:\u001b[39;00m\n\u001b[1;32m    471\u001b[0m \u001b[38;5;124;03m    batch: Integer, index of batch within the current epoch.\u001b[39;00m\n\u001b[1;32m    472\u001b[0m \u001b[38;5;124;03m    logs: Dict. Aggregated metric results up until this batch.\u001b[39;00m\n\u001b[1;32m    473\u001b[0m \u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[1;32m    474\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_should_call_train_batch_hooks:\n\u001b[0;32m--> 475\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_call_batch_hook(ModeKeys\u001b[38;5;241m.\u001b[39mTRAIN, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mend\u001b[39m\u001b[38;5;124m\"\u001b[39m, batch, logs\u001b[38;5;241m=\u001b[39mlogs)\n",
      "File \u001b[0;32m~/miniconda3/lib/python3.11/site-packages/keras/src/callbacks.py:322\u001b[0m, in \u001b[0;36mCallbackList._call_batch_hook\u001b[0;34m(self, mode, hook, batch, logs)\u001b[0m\n\u001b[1;32m    320\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_call_batch_begin_hook(mode, batch, logs)\n\u001b[1;32m    321\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m hook \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mend\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n\u001b[0;32m--> 322\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_call_batch_end_hook(mode, batch, logs)\n\u001b[1;32m    323\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m    324\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[1;32m    325\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mUnrecognized hook: \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mhook\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m. \u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m    326\u001b[0m         \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mExpected values are [\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mbegin\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m, \u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mend\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m]\u001b[39m\u001b[38;5;124m'\u001b[39m\n\u001b[1;32m    327\u001b[0m     )\n",
      "File \u001b[0;32m~/miniconda3/lib/python3.11/site-packages/keras/src/callbacks.py:345\u001b[0m, in \u001b[0;36mCallbackList._call_batch_end_hook\u001b[0;34m(self, mode, batch, logs)\u001b[0m\n\u001b[1;32m    342\u001b[0m     batch_time \u001b[38;5;241m=\u001b[39m time\u001b[38;5;241m.\u001b[39mtime() \u001b[38;5;241m-\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_batch_start_time\n\u001b[1;32m    343\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_batch_times\u001b[38;5;241m.\u001b[39mappend(batch_time)\n\u001b[0;32m--> 345\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_call_batch_hook_helper(hook_name, batch, logs)\n\u001b[1;32m    347\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_batch_times) \u001b[38;5;241m>\u001b[39m\u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_num_batches_for_timing_check:\n\u001b[1;32m    348\u001b[0m     end_hook_name \u001b[38;5;241m=\u001b[39m hook_name\n",
      "File \u001b[0;32m~/miniconda3/lib/python3.11/site-packages/keras/src/callbacks.py:393\u001b[0m, in \u001b[0;36mCallbackList._call_batch_hook_helper\u001b[0;34m(self, hook_name, batch, logs)\u001b[0m\n\u001b[1;32m    391\u001b[0m \u001b[38;5;28;01mfor\u001b[39;00m callback \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcallbacks:\n\u001b[1;32m    392\u001b[0m     hook \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mgetattr\u001b[39m(callback, hook_name)\n\u001b[0;32m--> 393\u001b[0m     hook(batch, logs)\n\u001b[1;32m    395\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_timing:\n\u001b[1;32m    396\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m hook_name \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_hook_times:\n",
      "File \u001b[0;32m~/miniconda3/lib/python3.11/site-packages/keras/src/callbacks.py:1093\u001b[0m, in \u001b[0;36mProgbarLogger.on_train_batch_end\u001b[0;34m(self, batch, logs)\u001b[0m\n\u001b[1;32m   1092\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mon_train_batch_end\u001b[39m(\u001b[38;5;28mself\u001b[39m, batch, logs\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mNone\u001b[39;00m):\n\u001b[0;32m-> 1093\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_batch_update_progbar(batch, logs)\n",
      "File \u001b[0;32m~/miniconda3/lib/python3.11/site-packages/keras/src/callbacks.py:1155\u001b[0m, in \u001b[0;36mProgbarLogger._batch_update_progbar\u001b[0;34m(self, batch, logs)\u001b[0m\n\u001b[1;32m   1153\u001b[0m \u001b[38;5;250m\u001b[39m\u001b[38;5;124;03m\"\"\"Updates the progbar.\"\"\"\u001b[39;00m\n\u001b[1;32m   1154\u001b[0m logs \u001b[38;5;241m=\u001b[39m logs \u001b[38;5;129;01mor\u001b[39;00m {}\n\u001b[0;32m-> 1155\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_maybe_init_progbar()\n\u001b[1;32m   1156\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39muse_steps:\n\u001b[1;32m   1157\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mseen \u001b[38;5;241m=\u001b[39m batch \u001b[38;5;241m+\u001b[39m \u001b[38;5;241m1\u001b[39m  \u001b[38;5;66;03m# One-indexed.\u001b[39;00m\n",
      "File \u001b[0;32m~/miniconda3/lib/python3.11/site-packages/keras/src/callbacks.py:1130\u001b[0m, in \u001b[0;36mProgbarLogger._maybe_init_progbar\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   1123\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mstateful_metrics \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mset\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mstateful_metrics)\n\u001b[1;32m   1125\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mmodel:\n\u001b[1;32m   1126\u001b[0m     \u001b[38;5;66;03m# Update the existing stateful metrics as `self.model.metrics` may\u001b[39;00m\n\u001b[1;32m   1127\u001b[0m     \u001b[38;5;66;03m# contain updated metrics after `MetricsContainer` is built in the\u001b[39;00m\n\u001b[1;32m   1128\u001b[0m     \u001b[38;5;66;03m# first train step.\u001b[39;00m\n\u001b[1;32m   1129\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mstateful_metrics \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mstateful_metrics\u001b[38;5;241m.\u001b[39munion(\n\u001b[0;32m-> 1130\u001b[0m         \u001b[38;5;28mset\u001b[39m(m\u001b[38;5;241m.\u001b[39mname \u001b[38;5;28;01mfor\u001b[39;00m m \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mmodel\u001b[38;5;241m.\u001b[39mmetrics)\n\u001b[1;32m   1131\u001b[0m     )\n\u001b[1;32m   1133\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mprogbar \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m   1134\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mprogbar \u001b[38;5;241m=\u001b[39m Progbar(\n\u001b[1;32m   1135\u001b[0m         target\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mtarget,\n\u001b[1;32m   1136\u001b[0m         verbose\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mverbose,\n\u001b[1;32m   1137\u001b[0m         stateful_metrics\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mstateful_metrics,\n\u001b[1;32m   1138\u001b[0m         unit_name\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mstep\u001b[39m\u001b[38;5;124m\"\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39muse_steps \u001b[38;5;28;01melse\u001b[39;00m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124msample\u001b[39m\u001b[38;5;124m\"\u001b[39m,\n\u001b[1;32m   1139\u001b[0m     )\n",
      "File \u001b[0;32m~/miniconda3/lib/python3.11/site-packages/keras/src/engine/training.py:917\u001b[0m, in \u001b[0;36mModel.metrics\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    915\u001b[0m         metrics \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcompiled_loss\u001b[38;5;241m.\u001b[39mmetrics\n\u001b[1;32m    916\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcompiled_metrics \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m--> 917\u001b[0m         metrics \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcompiled_metrics\u001b[38;5;241m.\u001b[39mmetrics\n\u001b[1;32m    919\u001b[0m \u001b[38;5;28;01mfor\u001b[39;00m l \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_flatten_layers():\n\u001b[1;32m    920\u001b[0m     metrics\u001b[38;5;241m.\u001b[39mextend(l\u001b[38;5;241m.\u001b[39m_metrics)\n",
      "File \u001b[0;32m~/miniconda3/lib/python3.11/site-packages/keras/src/engine/compile_utils.py:453\u001b[0m, in \u001b[0;36mMetricsContainer.metrics\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    444\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m duplicated:\n\u001b[1;32m    445\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[1;32m    446\u001b[0m             \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mFound duplicated metrics object in the user provided \u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m    447\u001b[0m             \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmetrics and weighted metrics. This will cause the same \u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m    450\u001b[0m             \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mDuplicated items: \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mduplicated\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m    451\u001b[0m         )\n\u001b[0;32m--> 453\u001b[0m \u001b[38;5;129m@property\u001b[39m\n\u001b[1;32m    454\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mmetrics\u001b[39m(\u001b[38;5;28mself\u001b[39m):\n\u001b[1;32m    455\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"All metrics in this container.\"\"\"\u001b[39;00m\n\u001b[1;32m    456\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_built:\n",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m: "
     ]
    }
   ],
   "source": [
    "# start the training process\n",
    "\n",
    "#history = recommendation_model.fit(\n",
    "    #x = x_train,\n",
    "    #y = y_train,\n",
    "   # batch_size = 16,\n",
    "   # epochs = 50,\n",
    "   # validation_data = (x_val, y_val)\n",
    "#)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 153,
   "metadata": {},
   "outputs": [],
   "source": [
    "book_df = new_books_df\n",
    "\n",
    "# take a sample of users\n",
    "user_id =  final_ratings_df['User-ID'].sample(1).iloc[0]\n",
    "books_read_by_user = final_ratings_df[final_ratings_df['User-ID'] == user_id]\n",
    "\n",
    "# create variable book_not_readed\n",
    "book_not_read = new_books_df[~new_books_df['Unique_ISBN'].isin(books_read_by_user['ISBN'].values)]['Unique_ISBN']\n",
    "book_not_read = list(\n",
    "    set(book_not_read)\n",
    "    .intersection(set(isbn_to_isbn_encoded.keys()))\n",
    ")\n",
    "\n",
    "book_not_read = [[isbn_to_isbn_encoded.get(x)] for x in book_not_read]\n",
    "user_encoder = encoded_user.get(user_id)\n",
    "user_book_array = np.hstack(\n",
    "    ([[user_encoder]] * len(book_not_read), book_not_read)\n",
    ")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 191,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unique_ISBN</th>\n",
       "      <th>Unique_Title</th>\n",
       "      <th>Unique_Author</th>\n",
       "      <th>Publication_Year_Unique</th>\n",
       "      <th>Unique_Publisher</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0000913154</td>\n",
       "      <td>The Way Things Work: An Illustrated Encycloped...</td>\n",
       "      <td>C. van Amerongen (translator)</td>\n",
       "      <td>1967.0</td>\n",
       "      <td>Simon &amp;amp; Schuster</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0001010565</td>\n",
       "      <td>Mog's Christmas</td>\n",
       "      <td>Judith Kerr</td>\n",
       "      <td>1992.0</td>\n",
       "      <td>Collins</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0001046438</td>\n",
       "      <td>Liar</td>\n",
       "      <td>Stephen Fry</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Harpercollins Uk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0001046713</td>\n",
       "      <td>Twopence to Cross the Mersey</td>\n",
       "      <td>Helen Forrester</td>\n",
       "      <td>1992.0</td>\n",
       "      <td>HarperCollins Publishers</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>000104687X</td>\n",
       "      <td>T.S. Eliot Reading \\The Wasteland\\\" and Other ...</td>\n",
       "      <td>T.S. Eliot</td>\n",
       "      <td>1993.0</td>\n",
       "      <td>HarperCollins Publishers</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19995</th>\n",
       "      <td>0140444696</td>\n",
       "      <td>The Kreutzer Sonata and Other Stories (Penguin...</td>\n",
       "      <td>Leo Tolstoy</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>Penguin Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19996</th>\n",
       "      <td>014044470X</td>\n",
       "      <td>The Fiancee and Other Stories (Penguin Classics)</td>\n",
       "      <td>Anton Pavlovich Chekhov</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>Penguin Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19997</th>\n",
       "      <td>0140444726</td>\n",
       "      <td>Jacques the Fatalist and His Master (Penguin C...</td>\n",
       "      <td>Denis Diderot</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>Penguin Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19998</th>\n",
       "      <td>0140444742</td>\n",
       "      <td>Seven Viking Romances (Penguin Classics)</td>\n",
       "      <td>Hermann Palsson</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>Penguin Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19999</th>\n",
       "      <td>0140444750</td>\n",
       "      <td>Early Christian Writings: The Apostolic Father...</td>\n",
       "      <td>Maxwell Staniforth</td>\n",
       "      <td>1987.0</td>\n",
       "      <td>Penguin Books</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>20000 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Unique_ISBN                                       Unique_Title  \\\n",
       "0      0000913154  The Way Things Work: An Illustrated Encycloped...   \n",
       "1      0001010565                                    Mog's Christmas   \n",
       "2      0001046438                                               Liar   \n",
       "3      0001046713                       Twopence to Cross the Mersey   \n",
       "4      000104687X  T.S. Eliot Reading \\The Wasteland\\\" and Other ...   \n",
       "...           ...                                                ...   \n",
       "19995  0140444696  The Kreutzer Sonata and Other Stories (Penguin...   \n",
       "19996  014044470X   The Fiancee and Other Stories (Penguin Classics)   \n",
       "19997  0140444726  Jacques the Fatalist and His Master (Penguin C...   \n",
       "19998  0140444742           Seven Viking Romances (Penguin Classics)   \n",
       "19999  0140444750  Early Christian Writings: The Apostolic Father...   \n",
       "\n",
       "                       Unique_Author  Publication_Year_Unique  \\\n",
       "0      C. van Amerongen (translator)                   1967.0   \n",
       "1                        Judith Kerr                   1992.0   \n",
       "2                        Stephen Fry                      0.0   \n",
       "3                    Helen Forrester                   1992.0   \n",
       "4                         T.S. Eliot                   1993.0   \n",
       "...                              ...                      ...   \n",
       "19995                    Leo Tolstoy                   1986.0   \n",
       "19996        Anton Pavlovich Chekhov                   1986.0   \n",
       "19997                  Denis Diderot                   1986.0   \n",
       "19998                Hermann Palsson                   1986.0   \n",
       "19999             Maxwell Staniforth                   1987.0   \n",
       "\n",
       "               Unique_Publisher  \n",
       "0          Simon &amp; Schuster  \n",
       "1                       Collins  \n",
       "2              Harpercollins Uk  \n",
       "3      HarperCollins Publishers  \n",
       "4      HarperCollins Publishers  \n",
       "...                         ...  \n",
       "19995             Penguin Books  \n",
       "19996             Penguin Books  \n",
       "19997             Penguin Books  \n",
       "19998             Penguin Books  \n",
       "19999             Penguin Books  \n",
       "\n",
       "[20000 rows x 5 columns]"
      ]
     },
     "execution_count": 191,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_books_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 198,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>User-ID</th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Rating</th>\n",
       "      <th>user</th>\n",
       "      <th>book_title</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>10650</th>\n",
       "      <td>446</td>\n",
       "      <td>0061000280</td>\n",
       "      <td>10.0</td>\n",
       "      <td>1005</td>\n",
       "      <td>9861</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2041</th>\n",
       "      <td>277478</td>\n",
       "      <td>0340565276</td>\n",
       "      <td>8.0</td>\n",
       "      <td>273</td>\n",
       "      <td>1978</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8668</th>\n",
       "      <td>278418</td>\n",
       "      <td>1569751544</td>\n",
       "      <td>3.0</td>\n",
       "      <td>678</td>\n",
       "      <td>8223</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1114</th>\n",
       "      <td>277195</td>\n",
       "      <td>0394726413</td>\n",
       "      <td>0.0</td>\n",
       "      <td>173</td>\n",
       "      <td>1098</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13902</th>\n",
       "      <td>1928</td>\n",
       "      <td>0373196903</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1511</td>\n",
       "      <td>12430</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11284</th>\n",
       "      <td>651</td>\n",
       "      <td>1888451084</td>\n",
       "      <td>7.0</td>\n",
       "      <td>1071</td>\n",
       "      <td>10381</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11964</th>\n",
       "      <td>929</td>\n",
       "      <td>0345331605</td>\n",
       "      <td>7.0</td>\n",
       "      <td>1163</td>\n",
       "      <td>10917</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5390</th>\n",
       "      <td>278418</td>\n",
       "      <td>0373121962</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>5066</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>860</th>\n",
       "      <td>277087</td>\n",
       "      <td>8472230082</td>\n",
       "      <td>5.0</td>\n",
       "      <td>139</td>\n",
       "      <td>850</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15795</th>\n",
       "      <td>2442</td>\n",
       "      <td>8804320095</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1706</td>\n",
       "      <td>13939</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>20000 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       User-ID        ISBN  Book-Rating  user  book_title\n",
       "10650      446  0061000280         10.0  1005        9861\n",
       "2041    277478  0340565276          8.0   273        1978\n",
       "8668    278418  1569751544          3.0   678        8223\n",
       "1114    277195  0394726413          0.0   173        1098\n",
       "13902     1928  0373196903          0.0  1511       12430\n",
       "...        ...         ...          ...   ...         ...\n",
       "11284      651  1888451084          7.0  1071       10381\n",
       "11964      929  0345331605          7.0  1163       10917\n",
       "5390    278418  0373121962          0.0   678        5066\n",
       "860     277087  8472230082          5.0   139         850\n",
       "15795     2442  8804320095          0.0  1706       13939\n",
       "\n",
       "[20000 rows x 5 columns]"
      ]
     },
     "execution_count": 198,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_ratings_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 161,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>User-ID</th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Rating</th>\n",
       "      <th>user</th>\n",
       "      <th>book_title</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>8668</th>\n",
       "      <td>278418</td>\n",
       "      <td>1569751544</td>\n",
       "      <td>3.0</td>\n",
       "      <td>678</td>\n",
       "      <td>8223</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8115</th>\n",
       "      <td>278418</td>\n",
       "      <td>0812583078</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>7674</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7879</th>\n",
       "      <td>278418</td>\n",
       "      <td>0689831420</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>7444</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5252</th>\n",
       "      <td>278418</td>\n",
       "      <td>0373098073</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>4929</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8094</th>\n",
       "      <td>278418</td>\n",
       "      <td>0812517024</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>7653</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5311</th>\n",
       "      <td>278418</td>\n",
       "      <td>0373107455</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>4988</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8322</th>\n",
       "      <td>278418</td>\n",
       "      <td>0866117393</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>7879</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4426</th>\n",
       "      <td>278418</td>\n",
       "      <td>0061091464</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>4127</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6265</th>\n",
       "      <td>278418</td>\n",
       "      <td>0439229030</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>5915</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5390</th>\n",
       "      <td>278418</td>\n",
       "      <td>0373121962</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>5066</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>4533 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      User-ID        ISBN  Book-Rating  user  book_title\n",
       "8668   278418  1569751544          3.0   678        8223\n",
       "8115   278418  0812583078          0.0   678        7674\n",
       "7879   278418  0689831420          0.0   678        7444\n",
       "5252   278418  0373098073          0.0   678        4929\n",
       "8094   278418  0812517024          0.0   678        7653\n",
       "...       ...         ...          ...   ...         ...\n",
       "5311   278418  0373107455          0.0   678        4988\n",
       "8322   278418  0866117393          0.0   678        7879\n",
       "4426   278418  0061091464          0.0   678        4127\n",
       "6265   278418  0439229030          0.0   678        5915\n",
       "5390   278418  0373121962          0.0   678        5066\n",
       "\n",
       "[4533 rows x 5 columns]"
      ]
     },
     "execution_count": 161,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "books_read_by_user"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 178,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>User-ID</th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Rating</th>\n",
       "      <th>user</th>\n",
       "      <th>book_title</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>10650</th>\n",
       "      <td>446</td>\n",
       "      <td>0061000280</td>\n",
       "      <td>10.0</td>\n",
       "      <td>1005</td>\n",
       "      <td>9861</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2041</th>\n",
       "      <td>277478</td>\n",
       "      <td>0340565276</td>\n",
       "      <td>8.0</td>\n",
       "      <td>273</td>\n",
       "      <td>1978</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8668</th>\n",
       "      <td>278418</td>\n",
       "      <td>1569751544</td>\n",
       "      <td>3.0</td>\n",
       "      <td>678</td>\n",
       "      <td>8223</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1114</th>\n",
       "      <td>277195</td>\n",
       "      <td>0394726413</td>\n",
       "      <td>0.0</td>\n",
       "      <td>173</td>\n",
       "      <td>1098</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13902</th>\n",
       "      <td>1928</td>\n",
       "      <td>0373196903</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1511</td>\n",
       "      <td>12430</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11284</th>\n",
       "      <td>651</td>\n",
       "      <td>1888451084</td>\n",
       "      <td>7.0</td>\n",
       "      <td>1071</td>\n",
       "      <td>10381</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11964</th>\n",
       "      <td>929</td>\n",
       "      <td>0345331605</td>\n",
       "      <td>7.0</td>\n",
       "      <td>1163</td>\n",
       "      <td>10917</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5390</th>\n",
       "      <td>278418</td>\n",
       "      <td>0373121962</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>5066</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>860</th>\n",
       "      <td>277087</td>\n",
       "      <td>8472230082</td>\n",
       "      <td>5.0</td>\n",
       "      <td>139</td>\n",
       "      <td>850</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15795</th>\n",
       "      <td>2442</td>\n",
       "      <td>8804320095</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1706</td>\n",
       "      <td>13939</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>20000 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       User-ID        ISBN  Book-Rating  user  book_title\n",
       "10650      446  0061000280         10.0  1005        9861\n",
       "2041    277478  0340565276          8.0   273        1978\n",
       "8668    278418  1569751544          3.0   678        8223\n",
       "1114    277195  0394726413          0.0   173        1098\n",
       "13902     1928  0373196903          0.0  1511       12430\n",
       "...        ...         ...          ...   ...         ...\n",
       "11284      651  1888451084          7.0  1071       10381\n",
       "11964      929  0345331605          7.0  1163       10917\n",
       "5390    278418  0373121962          0.0   678        5066\n",
       "860     277087  8472230082          5.0   139         850\n",
       "15795     2442  8804320095          0.0  1706       13939\n",
       "\n",
       "[20000 rows x 5 columns]"
      ]
     },
     "execution_count": 178,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_ratings_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 154,
   "metadata": {},
   "outputs": [],
   "source": [
    "recommendation_model.save_weights('user_based_model_weights.h5')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 186,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "28/28 [==============================] - 0s 1ms/step\n"
     ]
    }
   ],
   "source": [
    "ratings_model = recommendation_model.predict(user_book_array).flatten()\n",
    "\n",
    "\n",
    "top_ratings_indices = ratings_model.argsort()[-10:][::-1]\n",
    "\n",
    "recommended_book_ids = [\n",
    "    isbn_encoded_to_isbn.get(book_not_read[x][0]) for x in top_ratings_indices\n",
    "]\n",
    "\n",
    "top_book_user = (\n",
    "    books_read_by_user.sort_values(\n",
    "        by='Book-Rating',\n",
    "        ascending=False\n",
    "    )\n",
    "    .head(10)['ISBN'].values\n",
    ")\n",
    "\n",
    "book_df_rows = book_df[book_df['Unique_ISBN'].isin(top_book_user)]\n",
    "\n",
    "# Displays book recommendations in DataFrame form\n",
    "#book_df_rows_data = []\n",
    "#for row in book_df_rows.itertuples():\n",
    "   # book_df_rows_data.append([row.book_title, row.book_author])\n",
    "\n",
    "recommended_book = book_df[book_df['Unique_ISBN'].isin(recommended_book_ids)]\n",
    "\n",
    "recommended_book_data = []\n",
    "for row in recommended_book.itertuples():\n",
    "    recommended_book_data.append([row.Unique_Title, row.Unique_Author])\n",
    "\n",
    "# Create a DataFrame for output\n",
    "output_columns = ['Book Title', 'Book Author']\n",
    "df_books_read = pd.DataFrame(book_df_rows_data, columns=output_columns)\n",
    "df_recommended_books = pd.DataFrame(recommended_book_data, columns=output_columns)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 192,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['0440139791', '0394800168', '0310912520', '0553271571',\n",
       "       '0671019961', '0440920833', '0553131834', '0590413848',\n",
       "       '0440800129', '0898151899'], dtype=object)"
      ]
     },
     "execution_count": 192,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "top_book_user"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 195,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>User-ID</th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Rating</th>\n",
       "      <th>user</th>\n",
       "      <th>book_title</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>8668</th>\n",
       "      <td>278418</td>\n",
       "      <td>1569751544</td>\n",
       "      <td>3.0</td>\n",
       "      <td>678</td>\n",
       "      <td>8223</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8115</th>\n",
       "      <td>278418</td>\n",
       "      <td>0812583078</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>7674</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7879</th>\n",
       "      <td>278418</td>\n",
       "      <td>0689831420</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>7444</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5252</th>\n",
       "      <td>278418</td>\n",
       "      <td>0373098073</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>4929</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8094</th>\n",
       "      <td>278418</td>\n",
       "      <td>0812517024</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>7653</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5311</th>\n",
       "      <td>278418</td>\n",
       "      <td>0373107455</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>4988</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8322</th>\n",
       "      <td>278418</td>\n",
       "      <td>0866117393</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>7879</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4426</th>\n",
       "      <td>278418</td>\n",
       "      <td>0061091464</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>4127</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6265</th>\n",
       "      <td>278418</td>\n",
       "      <td>0439229030</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>5915</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5390</th>\n",
       "      <td>278418</td>\n",
       "      <td>0373121962</td>\n",
       "      <td>0.0</td>\n",
       "      <td>678</td>\n",
       "      <td>5066</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>4533 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      User-ID        ISBN  Book-Rating  user  book_title\n",
       "8668   278418  1569751544          3.0   678        8223\n",
       "8115   278418  0812583078          0.0   678        7674\n",
       "7879   278418  0689831420          0.0   678        7444\n",
       "5252   278418  0373098073          0.0   678        4929\n",
       "8094   278418  0812517024          0.0   678        7653\n",
       "...       ...         ...          ...   ...         ...\n",
       "5311   278418  0373107455          0.0   678        4988\n",
       "8322   278418  0866117393          0.0   678        7879\n",
       "4426   278418  0061091464          0.0   678        4127\n",
       "6265   278418  0439229030          0.0   678        5915\n",
       "5390   278418  0373121962          0.0   678        5066\n",
       "\n",
       "[4533 rows x 5 columns]"
      ]
     },
     "execution_count": 195,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "books_read_by_user"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 197,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unique_ISBN</th>\n",
       "      <th>Unique_Title</th>\n",
       "      <th>Unique_Author</th>\n",
       "      <th>Publication_Year_Unique</th>\n",
       "      <th>Unique_Publisher</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Empty DataFrame\n",
       "Columns: [Unique_ISBN, Unique_Title, Unique_Author, Publication_Year_Unique, Unique_Publisher]\n",
       "Index: []"
      ]
     },
     "execution_count": 197,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 171,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0        False\n",
       "1        False\n",
       "2        False\n",
       "3        False\n",
       "4        False\n",
       "         ...  \n",
       "19995    False\n",
       "19996    False\n",
       "19997    False\n",
       "19998    False\n",
       "19999    False\n",
       "Name: Unique_ISBN, Length: 20000, dtype: bool"
      ]
     },
     "execution_count": 171,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "book_df['Unique_ISBN'].isin(top_book_user)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 170,
   "metadata": {},
   "outputs": [
    {
     "ename": "AttributeError",
     "evalue": "'str' object has no attribute 'isin'",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "Cell \u001b[0;32mIn[170], line 1\u001b[0m\n\u001b[0;32m----> 1\u001b[0m [\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m0440139791\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;241m.\u001b[39misin(recommended_book_ids)]\n",
      "\u001b[0;31mAttributeError\u001b[0m: 'str' object has no attribute 'isin'"
     ]
    }
   ],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 166,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['0440139791', '0394800168', '0310912520', '0553271571',\n",
       "       '0671019961', '0440920833', '0553131834', '0590413848',\n",
       "       '0440800129', '0898151899'], dtype=object)"
      ]
     },
     "execution_count": 166,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "top_book_user"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 156,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Book Title</th>\n",
       "      <th>Book Author</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Love With the Proper Husband (Avon Historical ...</td>\n",
       "      <td>Victoria Alexander</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>The Poisonwood Bible</td>\n",
       "      <td>Barbara Kingsolver</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>I Know This Much Is True (Oprah's Book Club)</td>\n",
       "      <td>Wally Lamb</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>The Grandmothers : Four Short Novels</td>\n",
       "      <td>Doris Lessing</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>All Shall Be Well</td>\n",
       "      <td>Deborah Crombie</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>The Way to Freedom: Core Teachings of Tibetan ...</td>\n",
       "      <td>Bstan-Dzin-Rgya-Mtsho</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>For My Daughters</td>\n",
       "      <td>Barbara Delinsky</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Charity</td>\n",
       "      <td>Len Deighton</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>An Ice Cream War</td>\n",
       "      <td>William Boyd</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>The Deep End of the Ocean (Oprah's Book Club)</td>\n",
       "      <td>Jacquelyn Mitchard</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                          Book Title            Book Author\n",
       "0  Love With the Proper Husband (Avon Historical ...     Victoria Alexander\n",
       "1                               The Poisonwood Bible     Barbara Kingsolver\n",
       "2       I Know This Much Is True (Oprah's Book Club)             Wally Lamb\n",
       "3               The Grandmothers : Four Short Novels          Doris Lessing\n",
       "4                                  All Shall Be Well        Deborah Crombie\n",
       "5  The Way to Freedom: Core Teachings of Tibetan ...  Bstan-Dzin-Rgya-Mtsho\n",
       "6                                   For My Daughters       Barbara Delinsky\n",
       "7                                            Charity           Len Deighton\n",
       "8                                   An Ice Cream War           William Boyd\n",
       "9      The Deep End of the Ocean (Oprah's Book Club)     Jacquelyn Mitchard"
      ]
     },
     "execution_count": 156,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_recommended_books"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 199,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/1d/7ynr__411fx9qj9r1bgh72cc0000gn/T/ipykernel_7568/2164266257.py:1: DtypeWarning: Columns (3) have mixed types. Specify dtype option on import or set low_memory=False.\n",
      "  books1_df = pd.read_csv(books_data_path)\n"
     ]
    }
   ],
   "source": [
    "books1_df = pd.read_csv(books_data_path)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 200,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Year-Of-Publication</th>\n",
       "      <th>Publisher</th>\n",
       "      <th>Image-URL-S</th>\n",
       "      <th>Image-URL-M</th>\n",
       "      <th>Image-URL-L</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0195153448</td>\n",
       "      <td>Classical Mythology</td>\n",
       "      <td>Mark P. O. Morford</td>\n",
       "      <td>2002</td>\n",
       "      <td>Oxford University Press</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0002005018</td>\n",
       "      <td>Clara Callan</td>\n",
       "      <td>Richard Bruce Wright</td>\n",
       "      <td>2001</td>\n",
       "      <td>HarperFlamingo Canada</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0060973129</td>\n",
       "      <td>Decision in Normandy</td>\n",
       "      <td>Carlo D'Este</td>\n",
       "      <td>1991</td>\n",
       "      <td>HarperPerennial</td>\n",
       "      <td>http://images.amazon.com/images/P/0060973129.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0060973129.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0060973129.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0374157065</td>\n",
       "      <td>Flu: The Story of the Great Influenza Pandemic...</td>\n",
       "      <td>Gina Bari Kolata</td>\n",
       "      <td>1999</td>\n",
       "      <td>Farrar Straus Giroux</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0393045218</td>\n",
       "      <td>The Mummies of Urumchi</td>\n",
       "      <td>E. J. W. Barber</td>\n",
       "      <td>1999</td>\n",
       "      <td>W. W. Norton &amp;amp; Company</td>\n",
       "      <td>http://images.amazon.com/images/P/0393045218.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0393045218.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0393045218.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271355</th>\n",
       "      <td>0440400988</td>\n",
       "      <td>There's a Bat in Bunk Five</td>\n",
       "      <td>Paula Danziger</td>\n",
       "      <td>1988</td>\n",
       "      <td>Random House Childrens Pub (Mm)</td>\n",
       "      <td>http://images.amazon.com/images/P/0440400988.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0440400988.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0440400988.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271356</th>\n",
       "      <td>0525447644</td>\n",
       "      <td>From One to One Hundred</td>\n",
       "      <td>Teri Sloat</td>\n",
       "      <td>1991</td>\n",
       "      <td>Dutton Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0525447644.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0525447644.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0525447644.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271357</th>\n",
       "      <td>006008667X</td>\n",
       "      <td>Lily Dale : The True Story of the Town that Ta...</td>\n",
       "      <td>Christine Wicker</td>\n",
       "      <td>2004</td>\n",
       "      <td>HarperSanFrancisco</td>\n",
       "      <td>http://images.amazon.com/images/P/006008667X.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/006008667X.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/006008667X.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271358</th>\n",
       "      <td>0192126040</td>\n",
       "      <td>Republic (World's Classics)</td>\n",
       "      <td>Plato</td>\n",
       "      <td>1996</td>\n",
       "      <td>Oxford University Press</td>\n",
       "      <td>http://images.amazon.com/images/P/0192126040.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0192126040.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0192126040.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271359</th>\n",
       "      <td>0767409752</td>\n",
       "      <td>A Guided Tour of Rene Descartes' Meditations o...</td>\n",
       "      <td>Christopher  Biffle</td>\n",
       "      <td>2000</td>\n",
       "      <td>McGraw-Hill Humanities/Social Sciences/Languages</td>\n",
       "      <td>http://images.amazon.com/images/P/0767409752.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0767409752.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0767409752.0...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>271360 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              ISBN                                         Book-Title  \\\n",
       "0       0195153448                                Classical Mythology   \n",
       "1       0002005018                                       Clara Callan   \n",
       "2       0060973129                               Decision in Normandy   \n",
       "3       0374157065  Flu: The Story of the Great Influenza Pandemic...   \n",
       "4       0393045218                             The Mummies of Urumchi   \n",
       "...            ...                                                ...   \n",
       "271355  0440400988                         There's a Bat in Bunk Five   \n",
       "271356  0525447644                            From One to One Hundred   \n",
       "271357  006008667X  Lily Dale : The True Story of the Town that Ta...   \n",
       "271358  0192126040                        Republic (World's Classics)   \n",
       "271359  0767409752  A Guided Tour of Rene Descartes' Meditations o...   \n",
       "\n",
       "                 Book-Author Year-Of-Publication  \\\n",
       "0         Mark P. O. Morford                2002   \n",
       "1       Richard Bruce Wright                2001   \n",
       "2               Carlo D'Este                1991   \n",
       "3           Gina Bari Kolata                1999   \n",
       "4            E. J. W. Barber                1999   \n",
       "...                      ...                 ...   \n",
       "271355        Paula Danziger                1988   \n",
       "271356            Teri Sloat                1991   \n",
       "271357      Christine Wicker                2004   \n",
       "271358                 Plato                1996   \n",
       "271359   Christopher  Biffle                2000   \n",
       "\n",
       "                                               Publisher  \\\n",
       "0                                Oxford University Press   \n",
       "1                                  HarperFlamingo Canada   \n",
       "2                                        HarperPerennial   \n",
       "3                                   Farrar Straus Giroux   \n",
       "4                             W. W. Norton &amp; Company   \n",
       "...                                                  ...   \n",
       "271355                   Random House Childrens Pub (Mm)   \n",
       "271356                                      Dutton Books   \n",
       "271357                                HarperSanFrancisco   \n",
       "271358                           Oxford University Press   \n",
       "271359  McGraw-Hill Humanities/Social Sciences/Languages   \n",
       "\n",
       "                                              Image-URL-S  \\\n",
       "0       http://images.amazon.com/images/P/0195153448.0...   \n",
       "1       http://images.amazon.com/images/P/0002005018.0...   \n",
       "2       http://images.amazon.com/images/P/0060973129.0...   \n",
       "3       http://images.amazon.com/images/P/0374157065.0...   \n",
       "4       http://images.amazon.com/images/P/0393045218.0...   \n",
       "...                                                   ...   \n",
       "271355  http://images.amazon.com/images/P/0440400988.0...   \n",
       "271356  http://images.amazon.com/images/P/0525447644.0...   \n",
       "271357  http://images.amazon.com/images/P/006008667X.0...   \n",
       "271358  http://images.amazon.com/images/P/0192126040.0...   \n",
       "271359  http://images.amazon.com/images/P/0767409752.0...   \n",
       "\n",
       "                                              Image-URL-M  \\\n",
       "0       http://images.amazon.com/images/P/0195153448.0...   \n",
       "1       http://images.amazon.com/images/P/0002005018.0...   \n",
       "2       http://images.amazon.com/images/P/0060973129.0...   \n",
       "3       http://images.amazon.com/images/P/0374157065.0...   \n",
       "4       http://images.amazon.com/images/P/0393045218.0...   \n",
       "...                                                   ...   \n",
       "271355  http://images.amazon.com/images/P/0440400988.0...   \n",
       "271356  http://images.amazon.com/images/P/0525447644.0...   \n",
       "271357  http://images.amazon.com/images/P/006008667X.0...   \n",
       "271358  http://images.amazon.com/images/P/0192126040.0...   \n",
       "271359  http://images.amazon.com/images/P/0767409752.0...   \n",
       "\n",
       "                                              Image-URL-L  \n",
       "0       http://images.amazon.com/images/P/0195153448.0...  \n",
       "1       http://images.amazon.com/images/P/0002005018.0...  \n",
       "2       http://images.amazon.com/images/P/0060973129.0...  \n",
       "3       http://images.amazon.com/images/P/0374157065.0...  \n",
       "4       http://images.amazon.com/images/P/0393045218.0...  \n",
       "...                                                   ...  \n",
       "271355  http://images.amazon.com/images/P/0440400988.0...  \n",
       "271356  http://images.amazon.com/images/P/0525447644.0...  \n",
       "271357  http://images.amazon.com/images/P/006008667X.0...  \n",
       "271358  http://images.amazon.com/images/P/0192126040.0...  \n",
       "271359  http://images.amazon.com/images/P/0767409752.0...  \n",
       "\n",
       "[271360 rows x 8 columns]"
      ]
     },
     "execution_count": 200,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "books1_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 201,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Year-Of-Publication</th>\n",
       "      <th>Publisher</th>\n",
       "      <th>Image-URL-S</th>\n",
       "      <th>Image-URL-M</th>\n",
       "      <th>Image-URL-L</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Empty DataFrame\n",
       "Columns: [ISBN, Book-Title, Book-Author, Year-Of-Publication, Publisher, Image-URL-S, Image-URL-M, Image-URL-L]\n",
       "Index: []"
      ]
     },
     "execution_count": 201,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "books1_df[books1_df['ISBN'] == '0440139791']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
